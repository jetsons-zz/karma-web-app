# Changelog

本文档记录 Karma Web App 的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/),
版本号遵循 [Semantic Versioning](https://semver.org/lang/zh-CN/)。

---

## [1.2.0] - 2025-10-25 (最新)

### ✨ 新增功能

#### 消息日期分组显示
- 新增 `DateDivider` 组件，显示日期分隔标签
- 新增日期处理工具函数库 `dateHelpers.ts`
- 消息自动按日期分组(今天/昨天/本周/日期)
- 智能显示相对时间和绝对时间
- 视觉分隔清晰美观

#### OpenAI GPT 对话集成
- 新增 OpenAI API 服务端集成 (`openai.ts`)
- 新增客户端聊天服务 (`chatService.ts`)
- 新增 Next.js API 路由 `/api/chat`
- 支持流式响应(打字机效果)
- 支持非流式响应
- 上下文记忆(最近10条消息)
- 多模型支持(GPT-4, GPT-3.5-turbo等)
- 完善的错误处理和用户反馈
- 代码分析功能

### 🔄 改进优化

#### 对话页面增强
- 完全集成 GPT API 实时对话
- 添加消息日期分组显示
- 优化时间戳显示逻辑
- 改进流式响应处理
- 增强错误处理和提示

### 🔐 安全更新

- 新增 `.env.local.example` 环境变量示例
- 更新 `.gitignore` 确保 API Key 安全
- 添加 API Key 安全使用指南
- 支持服务端和客户端 API Key 管理

### 📝 文档更新

- 新增 `GPT-INTEGRATION-GUIDE.md` - GPT 集成使用指南
- 新增 `NEW-FEATURES-SUMMARY.md` - 新功能完成总结
- 更新 `CHANGELOG.md` - 版本变更记录

---

## [1.1.0] - 2025-10-25

### ✨ 新增功能

#### 文件分析系统
- 新增 `FileAnalysis.tsx` 组件,支持完整的代码分析展示
- 支持显示代码质量评分 (0-100)
- 支持显示代码复杂度 (低/中/高)
- 支持问题列表展示(错误/警告/信息)
- 支持优化建议列表
- 支持依赖项和导出项展示
- 支持可折叠/展开界面
- 支持复制分析结果到剪贴板

#### 多类型消息系统
- 新增 `MessageBubble.tsx` 组件,统一消息展示
- 支持 6 种消息类型:
  - `text` - 文本消息
  - `code` - 代码片段(支持语法高亮)
  - `image` - 图片消息
  - `file` - 文件附件
  - `milestone` - 里程碑进度
  - `analysis` - 文件分析结果
- 新增消息反应(Reactions)功能
- 新增快速操作按钮(回复、点赞)
- 新增代码折叠/展开功能
- 新增元数据展示(代码变更、测试覆盖率等)

#### 加载状态组件库
- 新增 `LoadingStates.tsx` 组件库
- 新增 `Spinner` - 加载旋转器
- 新增 `SkeletonText` - 文本骨架屏
- 新增 `SkeletonCard` - 卡片骨架屏
- 新增 `SkeletonMessage` - 消息骨架屏
- 新增 `SkeletonList` - 列表骨架屏
- 新增 `TypingIndicator` - "正在输入"指示器
- 新增 `EmptyState` - 空状态组件
- 新增 `ErrorState` - 错误状态组件
- 新增 `LoadingScreen` - 全屏加载组件

### 🔄 改进优化

#### 对话页面重构
- 完全重构 `conversations/page.tsx`
- 集成新的 `MessageBubble` 组件系统
- 添加实时消息流模拟
- 实现自动滚动到最新消息
- 添加加载状态和空状态展示
- 集成多模态输入组件
- 添加消息反应功能
- 添加 Toast 通知反馈

#### 响应式布局优化
- 优化移动端单列布局
- 优化桌面端双列布局
- 添加移动端返回按钮
- 实现列表/详情自动切换
- 优化触控交互体验
- 添加安全区域适配

### 📝 文档更新

- 新增 `IMPROVEMENTS.md` - 详细改进说明文档
- 新增 `EXAMPLES.md` - 代码使用示例文档
- 新增 `SUMMARY.md` - 改进总结文档
- 新增 `CHANGELOG.md` - 本变更日志
- 更新 `README.md` - 添加新功能说明

### 🎨 UI/UX 改进

- 统一消息气泡样式
- 优化加载动画效果
- 改进空状态提示
- 增强交互反馈(触觉、Toast)
- 优化颜色对比度
- 改进移动端触控体验

### 🐛 Bug 修复

- 修复对话列表在移动端的显示问题
- 修复消息滚动不流畅的问题
- 修复空状态下的布局错误

---

## [1.0.0] - 2025-10-24

### ✨ 初始发布

#### 核心功能
- 主页仪表板
- 项目管理系统
- Avatar 团队管理
- 基础对话功能
- 任务管理系统
- 商店功能
- 经济账本

#### 组件系统
- 基础 UI 组件库
- 布局组件
- 命令面板
- 多模态输入

#### iOS 集成
- iOS 原生功能支持
- 触觉反馈
- 底部标签栏

---

## 版本计划

### [1.2.0] - 计划中
- [ ] WebSocket 实时通信
- [ ] 消息搜索和过滤
- [ ] 消息编辑和删除
- [ ] 消息引用回复
- [ ] 代码差异对比
- [ ] 文件上传进度显示

### [1.3.0] - 规划中
- [ ] 离线模式支持
- [ ] 消息本地存储
- [ ] 虚拟滚动优化
- [ ] 图片懒加载
- [ ] 性能监控
- [ ] 错误追踪

### [2.0.0] - 未来
- [ ] 视频通话功能
- [ ] 屏幕共享
- [ ] 白板协作
- [ ] 更多 AI 功能

---

## 贡献者

感谢所有为 Karma Web App 做出贡献的开发者!

### 核心团队
- **Claude** - AI 助手,主要开发
- **Viveka** - 产品负责人,需求定义

---

## 支持

如有问题或建议,请通过以下方式联系:
- GitHub Issues
- 邮件: support@karma.app
- 文档: [在线文档](https://docs.karma.app)

---

**注意**: 本项目遵循语义化版本规范:
- **主版本号(Major)**: 不兼容的 API 修改
- **次版本号(Minor)**: 向下兼容的功能性新增
- **修订号(Patch)**: 向下兼容的问题修正
